---
title: useSorobanContract
description: Interact with Soroban smart contracts on Stellar
---

# useSorobanContract

The `useSorobanContract` hook provides a complete interface for interacting with Soroban smart contracts. It handles XDR value conversion, transaction simulation, and contract invocation.

## Features

- ðŸ“ž **Read-Only Calls**: Simulate contract functions without submitting transactions
- ðŸ”¨ **Build Invocations**: Create unsigned contract invocation XDR
- ðŸ” **Dev-Only Submission**: Sign and submit with secret keys (testing)
- ðŸ”„ **Automatic XDR Conversion**: JavaScript â†” Stellar type conversion
- ðŸ“Š **Complex Types**: Support for maps, vectors, addresses, and custom types

## Basic Usage

```tsx
import { useSorobanContract } from '@/hooks/useSorobanContract';

export default function ContractDemo() {
  const { callFunction, buildInvokeXDR, loading, error } = useSorobanContract({
    contractId: 'CDLZFC3SYJYDZT7K67VZ75HPJVIEUVNIXF47ZG2FB2RMQQAHHXK3AWCM',
    network: 'TESTNET',
  });

  const handleReadContract = async () => {
    const result = await callFunction('get_balance', ['GABC123...']);
    console.log('Balance:', result);
  };

  return (
    <button onClick={handleReadContract} disabled={loading}>
      Read Contract {loading && '(Loading...)'}
    </button>
  );
}
```

## API Reference

### Parameters

```typescript
useSorobanContract(options: {
  contractId: string;
  sorobanRpc?: string;
  network?: 'TESTNET' | 'PUBLIC';
}): SorobanContractReturn
```

| Parameter    | Type                    | Default                                 | Description                  |
| ------------ | ----------------------- | --------------------------------------- | ---------------------------- |
| `contractId` | `string`                | **Required**                            | Contract address (C-address) |
| `sorobanRpc` | `string`                | `'https://soroban-testnet.stellar.org'` | Soroban RPC endpoint         |
| `network`    | `'TESTNET' \| 'PUBLIC'` | `'TESTNET'`                             | Stellar network              |

### Return Value

```typescript
interface SorobanContractReturn {
  callFunction: (name: string, args: unknown[]) => Promise<unknown>;
  buildInvokeXDR: (name: string, args: unknown[]) => Promise<string>;
  submitInvokeWithSecret: (
    xdr: string,
    secret: string
  ) => Promise<SendTransactionResponse>;
  loading: boolean;
  error: Error | null;
}
```

## Methods

### callFunction()

Call a contract function in read-only mode (simulation).

```tsx
// Simple call
const balance = await callFunction('get_balance', ['GABC123...']);

// With multiple arguments
const result = await callFunction('transfer', [
  'GABC123...', // from
  'GDEF456...', // to
  1000, // amount
]);
```

**Supported Argument Types:**

- `string` â†’ ScvString
- `number` â†’ ScvI32
- `boolean` â†’ ScvBool
- `Address` â†’ ScvAddress
- `Array` â†’ ScvVec
- `Object` â†’ ScvMap

### buildInvokeXDR()

Build an unsigned contract invocation XDR.

```tsx
const xdr = await buildInvokeXDR('mint', [
  'GABC123...', // recipient
  1000, // amount
]);

// Sign with wallet
const signedXDR = await wallet.signTransaction(xdr);
```

### submitInvokeWithSecret() âš ï¸

**DEV-ONLY**: Sign and submit contract invocation.

```tsx
const result = await submitInvokeWithSecret(xdr, 'SABC123...');
console.log('Transaction status:', result.status);
```

> **Warning**: Never use in production. For testing only.

## Advanced Examples

### Complex Contract Calls

```tsx
// Call with Address type
import { Address } from '@stellar/stellar-sdk';

const recipient = new Address('GABC123...');
const result = await callFunction('transfer', [recipient, 1000]);
```

### Handling Contract Events

```tsx
const { callFunction } = useSorobanContract({ contractId });

const result = await callFunction('emit_event', ['test_event']);

// Listen for events with useSorobanEvents hook
```

### Error Handling

```tsx
const { callFunction, error } = useSorobanContract({ contractId });

try {
  const result = await callFunction('get_data', []);
} catch (err) {
  if (error?.message.includes('not found')) {
    console.log('Contract not deployed');
  }
}
```

## Type Conversion

### JavaScript to XDR

```tsx
// String
await callFunction('set_name', ['Alice']); // â†’ ScvString

// Number
await callFunction('set_count', [42]); // â†’ ScvI32

// Boolean
await callFunction('set_active', [true]); // â†’ ScvBool

// Array
await callFunction('set_list', [[1, 2, 3]]); // â†’ ScvVec

// Object
await callFunction('set_data', [{ key: 'value' }]); // â†’ ScvMap
```

### XDR to JavaScript

```tsx
const result = await callFunction('get_data', []);

// ScvString â†’ string
// ScvI32 â†’ number
// ScvBool â†’ boolean
// ScvVec â†’ Array
// ScvMap â†’ Object
```

## Best Practices

### 1. Cache Contract Instances

```tsx
const contractConfig = useMemo(
  () => ({
    contractId: 'CDLZ...',
    network: 'TESTNET',
  }),
  []
);

const contract = useSorobanContract(contractConfig);
```

### 2. Handle Loading States

```tsx
const { callFunction, loading } = useSorobanContract({ contractId });

if (loading) return <Spinner />;
```

### 3. Validate Contract Responses

```tsx
const result = await callFunction('get_balance', [address]);

if (typeof result !== 'number') {
  throw new Error('Invalid balance returned');
}
```

## Related Hooks

- [`useSorobanEvents`](/hooks/use-soroban-events) - Listen to contract events
- [`useStellarWallet`](/hooks/use-stellar-wallet) - Sign contract invocations

## Next Steps

<div className="grid grid-cols-1 md:grid-cols-2 gap-4 my-6">
  <a
    href="/hooks/use-soroban-events"
    className="block p-4 border rounded-lg hover:border-primary transition-colors"
  >
    <h4 className="font-semibold mb-2">useSorobanEvents</h4>
    <p className="text-sm text-muted-foreground">
      Listen to smart contract events
    </p>
  </a>

  <a
    href="/guides/smart-contracts"
    className="block p-4 border rounded-lg hover:border-primary transition-colors"
  >
    <h4 className="font-semibold mb-2">Smart Contracts Guide</h4>
    <p className="text-sm text-muted-foreground">
      Complete Soroban integration guide
    </p>
  </a>
</div>
